# Values.yaml ajustado según documentación Jenkins Kubernetes.pdf [cite: 85, 382]
renderTemplated: true

controller:
  componentName: "jenkins-controller"
  image: "jenkins/jenkins"
  tag: "2.541.1-jdk21"
  
  # Configuración de seguridad basada en el usuario 1000 [cite: 305]
  # Evita errores de lectura/escritura en el volumen persistente
  runAsUser: 1000
  fsGroup: 1000
  
  # Credenciales de Administrador inicial
  adminUser: "admin"
  adminPassword: "admin"

  # Almacenamiento Persistente basado en MicroK8s [cite: 11, 27, 105]
  persistence:
    enabled: true
    [cite_start]size: "8Gi"  # Capacidad solicitada en el PVC [cite: 105]
    [cite_start]storageClass: "microk8s-hostpath"  # Clase de almacenamiento para MicroK8s [cite: 27]

  # Configuración de Red: Servicio interno ClusterIP [cite: 211, 214]
  serviceType: "ClusterIP"
  
  # Configuración de Ingress para acceso externo [cite: 151, 155]
  ingress:
    enabled: true
    ingressClassName: "nginx"
    hostName: "jenkins.jrodrodriguez.es"
    annotations:
      kubernetes.io/ingress.class: "nginx"
      # Desactivar SSL temporalmente si no hay certificados configurados
      nginx.ingress.kubernetes.io/ssl-redirect: "false"

  # Plugins esenciales para el proyecto backend-mc-pnpm [cite: 382]
  installPlugins:
    - kubernetes:4025.v42ff33f324e5
    - workflow-aggregator:596.v8c21c963d92d
    - git:5.2.1
    - github:1.37.3.1
    - credentials-binding:644.v95b_6533d9d2f
    - configuration-as-code:1775.v810dc350b_ee5
    - dark-theme:635.v7ad9361ccd05

  # Sidecars desactivados para evitar errores de certificados SSL en el arranque
  sidecars:
    configAutoReload:
      enabled: false

# Configuración de la cuenta de servicio (RBAC) necesaria para agentes [cite: 8, 307, 317]
serviceAccount:
  create: true
  name: jenkins